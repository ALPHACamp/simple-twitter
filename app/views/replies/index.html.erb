<!-- profile -->
<div class="container">
  <div class="row">
    <div class ="col-md-3">
      <div class="form-group">
        <%= image_tag @user.avatar, size: "250"  %>
      </div>

      <div class="form-group">
        <h1><%= @user.name %></h1>
        <p><%= @user.introduction %></p>
      </div>

      <div class="form-group">
        <h3>Tweets    <%= @user.tweets.count %></h3>
        <h3>Following</h3>
        <h3>Follower</h3>
        <h3>Likes</h3>
      </div>

      <div class="form-group">
        <% if @user != current_user %>
          <% if current_user.following?(@user)%>
            <%= link_to 'Unfollow', followship_path(@user), method: :delete, class: "btn btn-default" %>
          <% else %>
            <%= link_to 'Follow',followships_path(following_id: @user), method: :post, class: "btn btn-default" %>
          <% end %>
        <% end %>
      </div>

      <div class="form-group">
        <% if @user.email == current_user.email %>
          <%= link_to 'Edit Profile', edit_user_path(@user), class:"btn btn-primary" %>
        <% end %>
      </div>

      <div class="clearfix"></div>
    </div>

    <!-- tweet -->
    <div class="col-md-9">
      <h1>Tweets</h1>
      <div class="tweet-item">
        <div class="row">
          <div class="col-md-3">
            <%= image_tag @tweet.user.avatar, size: "100" if @tweet.user.avatar? %>
          </div>
          <div class="col-md-9">
            <p>
              <%= link_to @tweet.user.name, tweets_user_path(@tweet.user) %>
              <%= @tweet.created_at.strftime("%Y-%m-%d, %H:%M") %>
            </p>
            <p>
              <%= @tweet.description %>
            </p>
            <div>
              <%= link_to 'Reply', tweet_replies_path(@tweet), class:"links links-blue" %>
              <% if @tweet.is_liked?(current_user) %>
                <%= link_to "Unlike", unlike_tweet_path(@tweet.id), method: :post, class: "links links-red" %>
              <% else %>
                <%= link_to "Like(#{@tweet.likes_count})", like_tweet_path(@tweet.id), method: :post, class: "links links-red" %>
              <% end %>
            </div>
          </div>
        </div>
      </div>

      <h1>Replies</h1>
      <% @tweet.replies.each do |reply| %>
        <div class="tweet-item">
          <div class="row">
            <div class="col-md-3">
              <%= image_tag reply.user.avatar, size: "100"%>
            </div>
            <div class="col-md-9">
              <h4><%= reply.user.name %></h4>
              <p><%= simple_format reply.comment %></p>
              <p class="text-muted">
                <em><%= reply.created_at %> </em>
              </p>
            </div>
          </div>
        </div>
      <% end %>
      <hr>

      <!-- create replies -->
      <div>
         <%= form_for [@tweet, @reply] do |f| %>
          <div class="form-group">
            <%= f.text_area :comment, class: "form-control text-area" %>
          </div>
          <div class="form-group">
            <%= f.submit class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>

    </div>
  </div>
</div>
