<h1>Simple Twitter前台</h1>

<div class="container">
  <div class="row">

    <ul class="nav nav-tabs">
      <li role="presentation">
        <%= link_to 'Index', root_path %>
      </li>
      <li role="presentation">
        <%= link_to 'Tweets', tweets_path %>
      </li>
      <li role="presentation" class="active">
        <%= link_to 'Users', users_path %>
      </li>
    </ul>

  </div>
</div>

<%= form_for @tweet do |f| %>
  <div class="form-group">
    <ul>
      <%= f.text_area :description, :size => "80x8", class: "form-control" %>
      <%= f.submit "Tweet", class: "btn btn-primary" %>  
    </ul>
  </div>
<% end %>

<ul>
    <li>
      <div class="avatar-pic">
        <%= image_tag current_user.avatar, :size => "100x100", class: "img-responsive img-rounded" %>
      </div>
      <%= current_user.name %>
      <%= link_to 'My Tweets', tweets_user_path(current_user) %>
    </li>
</ul>

<h2>Latest Tweets</h2>
<ul>
  <% @tweets.each do |tweet| %>
    <li>
      <%= image_tag tweet.user.avatar, :size => "100x100", class: "img-responsive img-rounded" %>
      <%= link_to tweet.user.name, tweets_user_path(tweet.user.id) %>
      <%= tweet.updated_at %>
      <%= tweet.description %>
      <%= link_to 'Reply', tweet_replies_path(tweet) %>
        <% if tweet.replies_count > 0 %>
          (<%= tweet.replies_count %>)
        <% end %>
      <% if tweet.user != current_user %>
        <% if tweet.is_liked?(current_user) %>
          <%= link_to 'Liked', unlike_tweet_path(tweet), method: :post, class: "btn btn-info" %>
        <% else %>
          <%= link_to 'Like', like_tweet_path(tweet), method: :post, class: "btn btn-primary" %>
        <% end %>
      <% else %>
        <%= 'Like' %>
      <% end %>
        <% if tweet.likes_count > 0 %>
          (<%= tweet.likes_count %>)
        <% end %>
    </li>
  <% end %>
</ul>

<h2>Popular User</h2>
<ul>
  <% @users.each do |user| %>
    <li>
      <td>
        <div class="avatar-pic">
          <%= image_tag user.avatar, :size => "100x100", class: "img-responsive img-rounded" %>
        </div>
      </td>
      <td><%= link_to user.name, tweets_user_path(user) %></td>
      <td><%= user.introduction %></td>

      <% if user != current_user %>
        <% if current_user.following?(user)%>
          <%= link_to 'Unfollow', followship_path(user), method: :delete, class: "btn btn-default" %>
        <% else %>
          <%= link_to 'Follow', followships_path(following_id: user), method: :post, class: "btn btn-warning" %>
        <% end %>
      <% end %>
      
    </li>
  <% end %>
</ul>